
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1. Discontinuous Galerkin methods for the wave equation &#8212; Numerical methods for wave-type equations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'explicit_methods/dg';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.2. DG Operators in NGSolve" href="dg_in_ngsolve.html" />
    <link rel="prev" title="5. Explicit methods for time-domain waves" href="../explicit_methods.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="Numerical methods for wave-type equations - Home"/>
    <script>document.write(`<img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="Numerical methods for wave-type equations - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Numerical methods for wave-type equations
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../modelling.html">1. Mathematical modeling of wave phenomena</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modelling/acoustic_td.html">1.1. Acoustic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/elastic_td.html">1.2. Elastic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/electromagnetic_td.html">1.3. Electromagnetic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/frequency-domain.html">1.4. Time-harmonic waves</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../first_numerics.html">2. Basic numerical methods for time-domain waves</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/method_of_lines.html">2.2. Space-time methods vs. the method of lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/fem_for_waveeq.html">2.3. A basic FE method for the acoustic wave equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/exercises.html">2.4. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../second_numerics.html">3. Basic numerical methods for frequency domain wave problems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/scattering_problems.html">3.1. FEM for scattering problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/resonance_problems.html">3.2. FEM for resonance problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/exercises.html">3.3. Exercises for time-harmonic waves</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../time_integration.html">4. Time-integration</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/second_order.html">4.1. Time-integration for the second order systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/mixed_methods.html">4.2. Mixed formulations for wave equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/first_order.html">4.3. Time-integration for the first order system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/exercises.html">4.4. Exercises for time-stepping schemes</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../explicit_methods.html">5. Explicit methods for time-domain waves</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.1. Discontinuous Galerkin methods for the wave equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dg_in_ngsolve.html">5.2. DG Operators in NGSolve</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markuswess/waves" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markuswess/waves/issues/new?title=Issue%20on%20page%20%2Fexplicit_methods/dg.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/explicit_methods/dg.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Discontinuous Galerkin methods for the wave equation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-fluxes-in-one-dimension">Numerical fluxes in one dimension</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jumps-and-averages">Jumps and averages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dg-in-higher-dimensions">DG in higher dimensions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="discontinuous-galerkin-methods-for-the-wave-equation">
<span id="dg"></span><h1><span class="section-number">5.1. </span>Discontinuous Galerkin methods for the wave equation<a class="headerlink" href="#discontinuous-galerkin-methods-for-the-wave-equation" title="Link to this heading">#</a></h1>
<p>We want to solve the first order system</p>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="math notranslate nohighlight" id="equation-wave-eq-1o">
<span class="eqno">(5.7)<a class="headerlink" href="#equation-wave-eq-1o" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
\partial_tv+\nabla p &amp;= f,&amp;\text{in }&amp;[0,T_0]\times \Omega,\\
\partial_t p+\nabla\cdot v &amp;=0,&amp;\text{in }&amp;[0,T_0]\times \Omega,\\
p(0,\cdot)&amp;=p_0,&amp;\text{in }&amp;\Omega,\\
v(0,\cdot)&amp;=v_0,&amp;\text{in }&amp;\Omega,\\
v\cdot n&amp;=0,&amp;\text{in }&amp;[0,T_0]\times \partial\Omega,\\
\end{aligned}\end{split}\]</div>
</div>
</div>
<p>numerically,  using <a class="reference internal" href="../time_integration/first_order.html#leap-frog"><span class="std std-ref">The Leap Frog time stepping</span></a>.
Since the computational effort depends mainly on the efficiency of the factorization of the mass matrices and the application of their inverses it would be benificial to use piecewise polynomial spaces, with basis functions supported only on single elements.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathcal T_h\)</span> be a decomposition of the domain <span class="math notranslate nohighlight">\(\Omega\)</span> into triangles/tetrahedra such that</p>
<div class="math notranslate nohighlight">
\[\bigcup_{T\in\mathcal T_h}\bar T = \bar \Omega.\]</div>
<p>Then we want to use the discrete spaces</p>
<div class="math notranslate nohighlight" id="equation-dg-spaces">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-dg-spaces" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
\mathcal W_h&amp;:=\left\{p\in L^2(\Omega): p|_T\in\mathcal P^k(T)\, \forall T\in\mathcal T_h\right\},\\
\mathcal V_h&amp;:=\left\{v\in L^2(\Omega)^2: v|_T\in\mathcal P^{k-1}(T)^2\, \forall T\in\mathcal T_h\right\},
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal P^k(T)=\mathrm{span}\{p:T\to\mathbb R: (x,y)\mapsto x^ly^m, l+m\leq k\}\)</span> for a fixed polynomial order <span class="math notranslate nohighlight">\(k\in\mathbb R\)</span>.</p>
<p>However, since <span class="math notranslate nohighlight">\(\mathcal W_h\subsetneq H^1(\Omega)\)</span> and <span class="math notranslate nohighlight">\(\mathcal V_h\subsetneq H(\mathrm{div})(\Omega)\)</span> the usual derivation of weak formulations fails. A naive attempt to just insert a basis of the discrete spaces <a class="reference internal" href="#equation-dg-spaces">(5.2)</a> into a weak formulation like <a class="reference internal" href="../time_integration/first_order.html#equation-semi-disc-1o">(4.12)</a> would yield a familiy of decoupled local problems on the single elements <span class="math notranslate nohighlight">\(T\)</span> with homogenuous boundary conditions but not an approxmation of the global problem.</p>
<p>This problem is fixed by modifying the weak forms <span class="math notranslate nohighlight">\(b,\tilde b\)</span> of the gradient and divergence, which for <span class="math notranslate nohighlight">\(p\in H^1(\Omega),v\in H(\mathrm{div})(\Omega)\)</span> and homogeneous Neumann boundary conditions should satisfy</p>
<div class="math notranslate nohighlight" id="equation-weak-grad">
<span class="eqno">(5.3)<a class="headerlink" href="#equation-weak-grad" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
b(p,v) &amp;= \int_\Omega \nabla p\cdot v,\\
\tilde b(v,p) &amp;= \int_\Omega \nabla\cdot v p=\int_\Omega v\cdot\nabla p = b(p,v).
\end{aligned}\end{split}\]</div>
<p>To motivate the following we consider the one-dimensional case first.</p>
<section id="numerical-fluxes-in-one-dimension">
<h2>Numerical fluxes in one dimension<a class="headerlink" href="#numerical-fluxes-in-one-dimension" title="Link to this heading">#</a></h2>
<p>Consider a one-dimensional mesh <span class="math notranslate nohighlight">\(\mathcal T = \{T_j = (a_{j-1},a_{j}), j = 1,\ldots N\}\)</span> for <span class="math notranslate nohighlight">\(a_0&lt;a_1&lt;\ldots&lt;a_N\)</span>.
Since <span class="math notranslate nohighlight">\(p\in \mathcal W_h\)</span>  is still piecewise smooth we may apply the gradient on each element. To make up for the lost information across the element boundaries we add a linear combination of the inner and outer boundary values at <span class="math notranslate nohighlight">\(a_j,a_{j-1}\)</span> with respect to each element, i.e.</p>
<div class="math notranslate nohighlight" id="equation-dg-grad">
<span class="eqno">(5.4)<a class="headerlink" href="#equation-dg-grad" title="Link to this equation">#</a></span>\[b(p,v) := \sum_{j=1}^N\int_{T_j} \nabla p\cdot v- \left(\alpha p_+(a_{j-1})+\beta p_-(a_{j-1})\right) v(a_{j-1})+\left(\alpha p_-(a_{j})+\beta p_+(a_{j})\right) v(a_j)\]</div>
<p>with <span class="math notranslate nohighlight">\(p_\pm(x)=\lim_{\varepsilon\to 0} p(x\pm\varepsilon)\)</span>, where we test with a smooth function <span class="math notranslate nohighlight">\(v\)</span>.
We want a consistent bilinear form, i.e., if we plug in <span class="math notranslate nohighlight">\(p\in H^1(\Omega)\)</span> we want to obtain the weak gradient from <a class="reference internal" href="#equation-weak-grad">(5.3)</a>. It immediately follows that for this hold we need to set <span class="math notranslate nohighlight">\(\beta = -\alpha\)</span>.
Using the notation <span class="math notranslate nohighlight">\(\{p\}:=\frac{1}{2}(p_++p_-)\)</span> we may rewrite <a class="reference internal" href="#equation-dg-grad">(5.4)</a> with <span class="math notranslate nohighlight">\(\beta=-\alpha\)</span> by</p>
<div class="math notranslate nohighlight" id="equation-dg-grad-mean">
<span class="eqno">(5.6)<a class="headerlink" href="#equation-dg-grad-mean" title="Link to this equation">#</a></span>\[b(p,v) = \sum_{j=1}^N\int_{T_j} \nabla p\cdot v- 2\alpha \left(\{p\}(a_{j-1})-p_+(a_{j-1})\right) v(a_{j-1})+ 2\alpha \left(\{p\}(a_{j})-p_-(a_{j})\right) v(a_{j})\]</div>
<p>Now note that the definition of <span class="math notranslate nohighlight">\(b\)</span> in <a class="reference internal" href="#equation-dg-grad">(5.4)</a> is also valid for <span class="math notranslate nohighlight">\(v\in L^2(\Omega)^2\)</span> (i.e., also for <span class="math notranslate nohighlight">\(v\in\mathcal V_h\)</span>) if we define it locally on each element. To obtain an energy preserving method we need <span class="math notranslate nohighlight">\(b(p,v)=\tilde b(v,p)\)</span>. Moreover we also want consistency of the <span class="math notranslate nohighlight">\(\tilde b\)</span> bilinear form, i.e., if we insert <span class="math notranslate nohighlight">\(v\in H^1(\Omega)\)</span> to obtain the weak divergence from <a class="reference internal" href="#equation-weak-grad">(5.3)</a>. Applying integration by parts in <a class="reference internal" href="#equation-dg-grad-mean">(5.6)</a></p>
<div class="math notranslate nohighlight" id="equation-dg-grad-mean">
<span class="eqno">(5.6)<a class="headerlink" href="#equation-dg-grad-mean" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
b(p,v) &amp;= \sum_{j=1}^N\int_{T_j} \nabla p\cdot v- 2\alpha \left(\{p\}(a_{j-1})-p_+(a_{j-1})\right) v(a_{j-1})+ 2\alpha \left(\{p\}(a_{j})-p_-(a_{j})\right) v(a_{j})\\
&amp;= \sum_{j=1}^N-\int_{T_j}  p\nabla\cdot v- \left(2\alpha \{p\}(a_{j-1})+(1-2\alpha)p_+(a_{j-1})\right)v(a_{j-1})+ \left(2\alpha \{p\}(a_{j})-(2\alpha-1)p_-(a_{j})\right) v(a_{j})
\end{aligned}\end{split}\]</div>
<p>which will be consistent for <span class="math notranslate nohighlight">\(\alpha=1/2\)</span>.</p>
</section>
<section id="jumps-and-averages">
<h2>Jumps and averages<a class="headerlink" href="#jumps-and-averages" title="Link to this heading">#</a></h2>
<p>For the discontinuous Galerkin (DG) spaces <a class="reference internal" href="#equation-dg-spaces">(5.2)</a> in higher dimensions we may define the average and jump operators as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\{\cdot\}&amp;:\begin{cases} W_h&amp;\to L^2(\mathcal S)\\
p&amp;\mapsto \left(x\mapsto \frac{1}{2}\lim_{\varepsilon\to 0}p(x+\varepsilon n)+p(x-\varepsilon n)\right)
\end{cases},\\
[\cdot]&amp;:\begin{cases} V_h&amp;\to L^2(\mathcal S)\\
v&amp;\mapsto \left(x\mapsto \frac{1}{2}\lim_{\varepsilon\to 0}v(x+\varepsilon n)\cdot n-v(x-\varepsilon n)\cdot n\right)
\end{cases},
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the outward normal and the skeleton <span class="math notranslate nohighlight">\(\mathcal S\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\mathcal S:=\bigcup_{T\in\mathcal T}\partial T.\]</div>
<div class="proof remark admonition" id="remark-0">
<p class="admonition-title"><span class="caption-number">Remark 5.1 </span></p>
<section class="remark-content" id="proof-content">
<p>The average and jump are independent of the choice of the normal vector <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>On the domain boundary the averaging operator can be adapted to fit boundary conditions</p>
</section>
</div></section>
<section id="dg-in-higher-dimensions">
<h2>DG in higher dimensions<a class="headerlink" href="#dg-in-higher-dimensions" title="Link to this heading">#</a></h2>
<p>Following the reasoning for the 1d case we obtain the general DG formulation</p>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="math notranslate nohighlight" id="equation-wave-eq-1o">
<span class="eqno">(5.7)<a class="headerlink" href="#equation-wave-eq-1o" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
\int_\Omega\partial_tv w+b(p,w) &amp;= \int_\Omega f w,\\
\partial_t \int_\Omega pq-b(q,v) &amp;=0,\\
p(0,\cdot)&amp;=p_0,\\
v(0,\cdot)&amp;=v_0,
\end{aligned}\end{split}\]</div>
<p class="sd-card-text">for all <span class="math notranslate nohighlight">\(w\in\mathcal V_h,q\in\mathcal W_h\)</span> with</p>
<div class="math notranslate nohighlight">
\[b(p,w) = \sum_{T\in\mathcal T} \int_T \nabla p\cdot w + \int_{\partial T}(\{p\}-p)w\]</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./explicit_methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../explicit_methods.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Explicit methods for time-domain waves</p>
      </div>
    </a>
    <a class="right-next"
       href="dg_in_ngsolve.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.2. </span>DG Operators in NGSolve</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-fluxes-in-one-dimension">Numerical fluxes in one dimension</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jumps-and-averages">Jumps and averages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dg-in-higher-dimensions">DG in higher dimensions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By M. Wess
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>