
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.3. Mass lumping for the wave equation &#8212; Numerical methods for wave-type equations</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'explicit_methods/mass_lumping';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.4. Integration rules in NGSolve" href="intrules.html" />
    <link rel="prev" title="5.2. DG Operators in NGSolve" href="dg_in_ngsolve.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="Numerical methods for wave-type equations - Home"/>
    <script>document.write(`<img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="Numerical methods for wave-type equations - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Numerical methods for wave-type equations
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../modelling.html">1. Mathematical modeling of wave phenomena</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modelling/acoustic_td.html">1.1. Acoustic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/elastic_td.html">1.2. Elastic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/electromagnetic_td.html">1.3. Electromagnetic waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modelling/frequency-domain.html">1.4. Time-harmonic waves</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../first_numerics.html">2. Basic numerical methods for time-domain waves</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/method_of_lines.html">2.2. Space-time methods vs. the method of lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/fem_for_waveeq.html">2.3. A basic FE method for the acoustic wave equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../first_numerics/exercises.html">2.4. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../second_numerics.html">3. Basic numerical methods for frequency domain wave problems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/scattering_problems.html">3.1. FEM for scattering problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/resonance_problems.html">3.2. FEM for resonance problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../second_numerics/exercises.html">3.3. Exercises for time-harmonic waves</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../time_integration.html">4. Time-integration</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/second_order.html">4.1. Time-integration for the second order systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/mixed_methods.html">4.2. Mixed formulations for wave equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/first_order.html">4.3. Time-integration for the first order system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_integration/exercises.html">4.4. Exercises for time-stepping schemes</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../explicit_methods.html">5. Explicit methods for time-domain waves</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dg.html">5.1. Discontinuous Galerkin methods for the wave equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dg_in_ngsolve.html">5.2. DG Operators in NGSolve</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.3. Mass lumping for the wave equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intrules.html">5.4. Integration rules in NGSolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises.html">5.5. Exercises for explicit methods</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../pmls.html">6. Perfectly Matched Layers</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../pmls/fq_domain.html">6.1. Perfectly Matched Layers in the Frequency Domain</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markuswess/waves" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markuswess/waves/issues/new?title=Issue%20on%20page%20%2Fexplicit_methods/mass_lumping.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/explicit_methods/mass_lumping.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mass lumping for the wave equation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-for-linear-finite-elements">Mass lumping for linear finite elements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-for-linear-1d-elements">Mass lumping for linear 1d elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-in-higher-dimensions">Mass lumping in higher dimensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping">Higher order mass lumping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-in-one-dimension">Higher order mass lumping in one dimension</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-for-quadrilaterals-and-hexahedra">Higher order mass lumping for quadrilaterals and hexahedra</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-on-simplexes">Higher order mass lumping on simplexes</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mass-lumping-for-the-wave-equation">
<span id="mass-lumping"></span><h1><span class="section-number">5.3. </span>Mass lumping for the wave equation<a class="headerlink" href="#mass-lumping-for-the-wave-equation" title="Link to this heading">#</a></h1>
<p>A different approach to DG methods from <a class="reference internal" href="dg.html#dg"><span class="std std-numref">Section 5.1</span></a> to obtain easily invertible mass matrices is the so called mass lumping. We consider the one-dimensional case first</p>
<section id="mass-lumping-for-linear-finite-elements">
<span id="mass-lumping-1o"></span><h2>Mass lumping for linear finite elements<a class="headerlink" href="#mass-lumping-for-linear-finite-elements" title="Link to this heading">#</a></h2>
<p>We focus on the simple case of linear finite elements, first in one and subsequently in higher dimensions.</p>
<section id="mass-lumping-for-linear-1d-elements">
<h3>Mass lumping for linear 1d elements<a class="headerlink" href="#mass-lumping-for-linear-1d-elements" title="Link to this heading">#</a></h3>
<p>Suppose our spacial domain is given by the interval <span class="math notranslate nohighlight">\(\Omega=(a,b)\)</span> decomposed into <span class="math notranslate nohighlight">\(N\in\mathbb N\)</span> subintervals <span class="math notranslate nohighlight">\(T_j:=(a_{j-1},a_j):=(a_{j-1},a_{j-1}+d_j\)</span> with <span class="math notranslate nohighlight">\(a=a_0&lt;a_j&lt;\ldots&lt;a_N=b\)</span> and <span class="math notranslate nohighlight">\(d_j=a_{j}-a_{j-1}\)</span> for <span class="math notranslate nohighlight">\(j=1,\ldots, N\)</span>.</p>
<p>Then the classical hat function basis of a first order finite element space is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}V_h = \mathrm{span}\{b_j, j = 0,\ldots, N\},\quad b_j =\begin{cases}\frac{x-a_{j-1}}{d_j},&amp;x\in T_j\\\frac{a_{j+1}-x}{d_{j+1}},&amp;x\in T_{j+1}\\0,&amp;\mathrm{else}\end{cases}\end{split}\]</div>
<p>with the appropriate restrictions for <span class="math notranslate nohighlight">\(b_0,b_N\)</span>.</p>
<p>The entries of the mass matrix can be easily computed by hand via</p>
<div class="math notranslate nohighlight">
\[\begin{split}m_{i,j}=\int_a^b b_j b_i = \begin{cases}
\int_{a_{j-1}}^{a_{j+1}}b_j^2=(d_j+d_{j+1})\int_0^1 x^2 dx=\frac{d_j+d_{j+1}}{3},&amp;i=j,\\
\int_{a_j}^{a_{j+1}}b_j b_{j+1}=d_{j+1}\int_0^1 x(1-x)dx = \frac{d_{j+1}}{6},&amp;i=j+1,\\
\int_{a_{j-1}}^{a_{j}}b_j b_{j-1}=d_{j}\int_0^1 x(1-x)dx = \frac{d_{j}}{6},&amp;i=j-1,\\
0,&amp;\mathrm{else,}\end{cases}\end{split}\]</div>
<p>where we set <span class="math notranslate nohighlight">\(d_0=d_{N+1}=0\)</span>.
Instead of computing the integrals for the entries of the mass matrix exactly we may approximate them using the trapezoidal rule</p>
<div class="math notranslate nohighlight">
\[\int_a^b f \approx I_{a,b}f:= \frac{b-a}{2}(f(a)+f(b)).\]</div>
<p>which leads to an approximated mass matrix <span class="math notranslate nohighlight">\(\tilde{\mathbf M}\)</span> with entries</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\tilde m_{i,j}&amp;=I_{a,b} (b_j b_i) \\
&amp;=\sum_{k=1}^N I_{a_{k-1},a_k}(b_j,b_i)\\
&amp;=\sum_{k=1}^N \frac{d_k}{2}(b_j(a_{k-1})b_i(a_{k-1})+b_j(a_{k})b_i(a_{k}))\\
&amp;=\frac{d_1}{2}b_i(a_0)b_j(a_0)+\sum_{k=1}^{N-1}\frac{d_k+d_{k+1}}{2}b_j(a_k)b_i(a_k)+\frac{d_N}{2}b_j(a_N)b_i(a_N)\\
&amp;=
\begin{cases}
\frac{d_i+d_{i+1}}{2},&amp; i=j,\\
0,&amp;\mathrm{else.}\end{cases}
\end{aligned}\end{split}\]</div>
</section>
<section id="mass-lumping-in-higher-dimensions">
<h3>Mass lumping in higher dimensions<a class="headerlink" href="#mass-lumping-in-higher-dimensions" title="Link to this heading">#</a></h3>
<p>For higher dimensions the first order finite element spaces (for triangular or tetrahedral elements <span class="math notranslate nohighlight">\(T\in\mathcal T\)</span>) are again given by piecewise linear functions. A convenient basis is given by the according functions which vanish on all but one vertex points, i.e.,</p>
<div class="math notranslate nohighlight">
\[V_h = \{f\in H^1(\Omega): f|_T\in \mathcal P^1,\forall T\in\mathcal T\}\]</div>
<p>where the polynomial space <span class="math notranslate nohighlight">\(\mathcal P^k\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\mathcal P^k:=\{(x,y,z)\mapsto x^ny^mz^l:n+m+l\leq k\},\]</div>
<p>(and in two dimensions the exponent <span class="math notranslate nohighlight">\(l\)</span> of the <span class="math notranslate nohighlight">\(z\)</span> coordinate is always <span class="math notranslate nohighlight">\(0\)</span>).
If we denote the set of vertices by <span class="math notranslate nohighlight">\(V_0,\ldots,V_N\)</span> the nodal basis is given by the condition</p>
<div class="math notranslate nohighlight">
\[b_j(V_i)=\delta_{j,i}.\]</div>
<p>Following the same reasoning as in one dimension we may construct integration rules locally on each element <span class="math notranslate nohighlight">\(T\)</span> by</p>
<div class="math notranslate nohighlight">
\[I_T(f):=\frac{|T|}{d+1}\sum_{i=0}^{d+1} f(V_{T,i})\]</div>
<p>where <span class="math notranslate nohighlight">\(V_{T_i}\)</span> are the vertices of the element <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(d\)</span> is the spacial dimension.
Again an approximation to the correct mass integrals is given by</p>
<div class="math notranslate nohighlight">
\[\tilde m_{i,j}:=\sum_{T\in\mathcal T} I_T(b_ib_j)=\delta_{i,j}\frac{1}{d+1}\sum_{k=1}^{K_i} |T_{i,k}|\]</div>
<p>where  <span class="math notranslate nohighlight">\(T_{i,k},k=1,\ldots,K_i\)</span> are the elements sharing the vertex <span class="math notranslate nohighlight">\(V_i\)</span> and <span class="math notranslate nohighlight">\(K_i\)</span> is the number of these elements.</p>
</section>
</section>
<section id="higher-order-mass-lumping">
<h2>Higher order mass lumping<a class="headerlink" href="#higher-order-mass-lumping" title="Link to this heading">#</a></h2>
<p>Usually finite element basis functions are defined on a reference element first. Then they are appropriately transformed to the physical elements and basis functions on neighbouring elements are glued together to obtain conforming basis functions. I.e., if <span class="math notranslate nohighlight">\(T\)</span> is a physical element (interval, triangle, quadrilateral, tetrahedron, hexahedron,…) we have a reference element <span class="math notranslate nohighlight">\(\hat T\)</span> and a diffeomorphism  <span class="math notranslate nohighlight">\(\phi:\hat T\to T\)</span>.
If a local basis function <span class="math notranslate nohighlight">\(\hat b:\hat T\to\mathbb R\)</span> is given then the basis function on the phyiscal element is given by <span class="math notranslate nohighlight">\(b := \hat b \circ \phi ^{-1}\)</span>.
We use the following reference elements:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\hat T_{\mathrm{segm}} &amp;= \mathrm{conv}\{0,1\}=[0,1],\\
\hat T_{\mathrm{trig}} &amp;= \mathrm{conv}\{(0,0),(1,0),(0,1)\},\\
\hat T_{\mathrm{tet}} &amp;= \mathrm{conv}\{(0,0,0),(1,0,0),(0,1,0),(0,0,1)\} ,\\
\hat T_{\mathrm{quad}} &amp;= \mathrm{conv}\{(0,0),(1,0),(0,1),(1,1)\}=[0,1]^2,\\
\hat T_{\mathrm{hex}} &amp;= \mathrm{conv}\{(0,0,0),(1,0,0),(0,1,0),(1,1,0),(0,0,1),(1,0,1),(0,1,1),(1,1,1)\}=[0,1]^3,
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{conv}\)</span> denotes the convex hull of a set.</p>
<p>For a given integration rule consisting of integration points <span class="math notranslate nohighlight">\(\hat x_j\in \hat T\)</span> we use basis functions which vanish in all but one integration points, i.e.,</p>
<div class="math notranslate nohighlight">
\[\hat b_i(\hat x_j)=\delta_{i,j}.\]</div>
<p>The task is now to find suitable integration rules and spaces on the reference elements.</p>
<section id="higher-order-mass-lumping-in-one-dimension">
<h3>Higher order mass lumping in one dimension<a class="headerlink" href="#higher-order-mass-lumping-in-one-dimension" title="Link to this heading">#</a></h3>
<p>To be able to couple the mapped basis functions on two adjoining elements (intervals) we need to fix the endpoints <span class="math notranslate nohighlight">\(0,1\)</span> of the reference interval <span class="math notranslate nohighlight">\(T_{\mathrm{segm}}\)</span> as integration points. Then for a given total number of points <span class="math notranslate nohighlight">\(N+1\)</span> the integration rule with highest order is the Gauss-Lobatto rule which is exact for polynomials of up to order <span class="math notranslate nohighlight">\(2N-1\)</span>.</p>
<p>As local spaces we may choose the spaces of polynomials of up to order <span class="math notranslate nohighlight">\(N\)</span> with the Lagrangian basis</p>
<div class="math notranslate nohighlight">
\[\hat b_j(x):= \prod_{k=0,k\neq j}^N\frac{x-\hat x_k}{\hat x_j-\hat x_k},\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat x_j\)</span> denote the integration points on the reference element. The basis functions are then mapped to the physical elements as described above and the first basis function of an element is glued to the last basis function of the previous element to obtain globally continuous basis functions.</p>
</section>
<section id="higher-order-mass-lumping-for-quadrilaterals-and-hexahedra">
<h3>Higher order mass lumping for quadrilaterals and hexahedra<a class="headerlink" href="#higher-order-mass-lumping-for-quadrilaterals-and-hexahedra" title="Link to this heading">#</a></h3>
<p>In the case of quadrilaterals and hexahedra integration rules may be obtained by tensorizing the one dimensional Gauss-Lobatto rules. I.e., if a Gauss-Lobatto rule is given by the points <span class="math notranslate nohighlight">\(\hat x_0,\ldots,\hat x_N\)</span> and weights <span class="math notranslate nohighlight">\(\hat w_0,\ldots, \hat w_N\)</span> we define</p>
<div class="math notranslate nohighlight">
\[\hat {\mathbf x}_{i+(N+1)j}:=(\hat x_i,\hat x_j)^\top,\quad \hat {\mathbf w}_{i+(N+1)j}:=\hat w_i\hat w_j,\]</div>
<p>on the unit square.
The according Lagrangian polynomial basis is given by</p>
<div class="math notranslate nohighlight">
\[\hat{\mathbf b}_{i+(N+1)j}(x,y) = \hat b_i(x)\hat b_j(y).\]</div>
<p>Note that here we use the polynomial space</p>
<div class="math notranslate nohighlight">
\[\mathcal Q^N:=\{x^ky^l:k,l\leq N\}\]</div>
<p>which differs from <span class="math notranslate nohighlight">\(\mathcal P^N\)</span>.
For three dimensions the construction works similarly.</p>
</section>
<section id="higher-order-mass-lumping-on-simplexes">
<h3>Higher order mass lumping on simplexes<a class="headerlink" href="#higher-order-mass-lumping-on-simplexes" title="Link to this heading">#</a></h3>
<p>A naive ansatz to construct a second order mass-lumping method for triangles would be to follow the ideas from the first-order case: There we used the given basis and constructed a suitable integration rule. Since the dimension of <span class="math notranslate nohighlight">\(\mathcal P^2\)</span> is <span class="math notranslate nohighlight">\(6\)</span> and we need three symmetric degrees of freedom on each boundary to ensure continuity of the correctly coupled basis functions. The integration points on the reference triangle are fixed by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\hat{\mathbf x}_1&amp;=(0,0),&amp;
\hat{\mathbf x}_2&amp;=(1/2,0),&amp;
\hat{\mathbf x}_3&amp;=(1,0),\\
\hat{\mathbf x}_4&amp;=(1/2,1/2),&amp;
\hat{\mathbf x}_5&amp;=(0,1),&amp;
\hat{\mathbf x}_6&amp;=(0,1/2)\}.
\end{aligned}\end{split}\]</div>
<p>The nodal basis functions are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\hat b_1 &amp;= 2(1-x-y)(1-x-y-\frac{1}{2}),&amp;
\hat b_2 &amp;= 4(1-x-y)x,&amp;
\hat b_3 &amp;= 2x(x-\frac{1}{2})\\
\hat b_4 &amp;= 4xy,&amp;
\hat b_5 &amp;= 2y(1-\frac{1}{2}),&amp;
\hat b_6 &amp;= 4y(1-x-y).
\end{aligned}\end{split}\]</div>
<p>It remains to specify the integration weights to obtain an optimal accuracy. Due to symmetry we only have to specify two weights <span class="math notranslate nohighlight">\(w_2=w_4=w_6=w_E\)</span> for the mid-points of the edges and <span class="math notranslate nohighlight">\(w_1=w_3=w_5=w_V\)</span> for the vertices, i.e., our integration rule is given by</p>
<div class="math notranslate nohighlight">
\[I_{\hat T}(f)=w_V\left(f(\hat{\mathbf x}_1)+f(\hat{\mathbf x}_3)+f(\hat{\mathbf x}_5)\right)+w_E\left(f(\hat{\mathbf x}_2)+f(\hat{\mathbf x}_4)+f(\hat{\mathbf x}_6)\right).\]</div>
<p>The condition that constants are integrated exactly yields</p>
<div class="math notranslate nohighlight">
\[\frac{1}{2}=3w_V+3w_E.\]</div>
<p>Imposing that also the function <span class="math notranslate nohighlight">\((x,y)\mapsto x\)</span> is integrated exactly yields</p>
<div class="math notranslate nohighlight">
\[\int_{\hat T}xdx=\frac{1}{6}=w_V\left(0+1+0\right)+w_E\left(\frac{1}{2}+\frac{1}{2}+0\right)=w_V+w_E,\]</div>
<p>which is the same condition as before. Imposing that also the function <span class="math notranslate nohighlight">\((x,y)=x^2\)</span> is integrated exactly yields</p>
<div class="math notranslate nohighlight">
\[\int_{\hat T} x^2 dx = \int_0^1\int_0^{1-x} x^2 dydx = \int_0^1x^2-x^3 dx = \frac{1}{12}
=w_V\left(0+1+0\right)+w_E\left(\frac{1}{4}+\frac{1}{4}+0\right)=w_V+\frac{1}{2}w_E.\]</div>
<p>Inserting the first condition <span class="math notranslate nohighlight">\(w_E=1/6-w_V\)</span> yields</p>
<div class="math notranslate nohighlight">
\[w_V = 0,\quad w_E = \frac{1}{6}.\]</div>
<p>Using this quadrature for approximating our mass matrix is not an option since we would end up with a singular approximated mass matrix. We may settle for an integration rule which only integrates linear functions exactly, however it turns out that this will also reduce the overall convergence order of the resulting method.</p>
<p>The remedy to this problem is to add an additional integration point to the integration rule. From symmetry considerations this can only be the center <span class="math notranslate nohighlight">\(\hat{\mathbf x}_7=(1/3,1/3)\)</span> of the reference triangle.</p>
<p>We also have to enlargen the local space of polynomials by another basis function.</p>
<p>Since this has to be a basis function corresponding to the integration point in the center we have to choose a bubble function namely <span class="math notranslate nohighlight">\(\tilde b_7(x,y):= 27xy(1-x-y)\}.\)</span>
The resulting space</p>
<div class="math notranslate nohighlight">
\[\hat V_h:=\mathcal P^2\oplus \mathrm{span}\{\tilde b_7\}=\mathrm{span}\left\{\hat b_1,\hat b_2,\hat b_3,\hat b_4,\hat b_5,\hat b_6,\tilde b_7\right\}\]</div>
<p>now lies in between the polynomial spaces <span class="math notranslate nohighlight">\(\mathcal P^2\)</span> and <span class="math notranslate nohighlight">\(\mathcal P^3\)</span>. To obtain a Lagrangian basis with respect to the integration points one may simply use the Lagrangian basis of <span class="math notranslate nohighlight">\(\mathcal P^2\)</span> with respect to the original integration points and subtract the bubble function, i.e.,</p>
<div class="math notranslate nohighlight">
\[\tilde b_j = \frac{\hat b_j+\tilde b_7}{1+\hat b_j(1/3,1/3)},\quad j=1,\ldots,6.\]</div>
<p>It remains to specify the correct weights for the integration rule.</p>
<div class="proof theorem admonition" id="theorem-0">
<p class="admonition-title"><span class="caption-number">Theorem 5.2 </span></p>
<section class="theorem-content" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\tilde b_j\)</span>, <span class="math notranslate nohighlight">\(\mathbf x_j\)</span> be given as above. Moreover we define</p>
<div class="math notranslate nohighlight">
\[w_1=w_3=w_5=\frac{1}{40},\quad w_2=w_4=w_6=\frac{1}{15},\quad w_7 = \frac{9}{40}.\]</div>
<p>Then the quadrature rule given by <span class="math notranslate nohighlight">\(\mathbf x_j,\omega_j\)</span> is exact for all functions from <span class="math notranslate nohighlight">\(\mathcal P^3\)</span>.</p>
</section>
</div><div class="proof remark admonition" id="remark-1">
<p class="admonition-title"><span class="caption-number">Remark 5.2 </span></p>
<section class="remark-content" id="proof-content">
<p>It turns out that a sufficient condition for the integration rule to not spoil the convergence of the method is that it is exact for <span class="math notranslate nohighlight">\(\mathcal P^{k+\tilde k-2}\)</span> if the space on the reference element <span class="math notranslate nohighlight">\(\hat V_h\)</span> is given by <span class="math notranslate nohighlight">\(\mathcal P^k\oplus \tilde V_h\)</span> with <span class="math notranslate nohighlight">\(\tilde V_h\subset \mathcal P^{\tilde k}\)</span>. This means that the integration rule defined above fo the second order mass lumping space is sufficient.</p>
</section>
</div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./explicit_methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dg_in_ngsolve.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.2. </span>DG Operators in NGSolve</p>
      </div>
    </a>
    <a class="right-next"
       href="intrules.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.4. </span>Integration rules in NGSolve</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-for-linear-finite-elements">Mass lumping for linear finite elements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-for-linear-1d-elements">Mass lumping for linear 1d elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-lumping-in-higher-dimensions">Mass lumping in higher dimensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping">Higher order mass lumping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-in-one-dimension">Higher order mass lumping in one dimension</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-for-quadrilaterals-and-hexahedra">Higher order mass lumping for quadrilaterals and hexahedra</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-order-mass-lumping-on-simplexes">Higher order mass lumping on simplexes</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By M. Wess
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>